# EasyChat 前端应用部署指南

本指南旨在详细说明如何在一台新的主机上，从零开始构建和部署 EasyChat 前端应用。

## 第一步：准备构建环境

在开始之前，请确保新主机上已经安装了以下必备软件：

-   **Node.js**: 推荐使用 16.x 或更高的长期支持（LTS）版本。您可以访问 [Node.js 官网](https://nodejs.org/) 下载并安装。安装 Node.js 会自动包含 `npm`（Node.js 包管理器）。
-   **Git**: 用于从代码仓库拉取最新的前端代码。您可以从 [Git 官网](https://git-scm.com/) 下载。

您可以在终端或命令行中运行以下命令来验证安装是否成功：
```bash
node -v
npm -v
git --version
```

## 第二步：获取并配置源码

1.  **克隆代码仓库**
    打开终端，进入您希望存放项目的目录，然后运行 `git clone` 命令来下载项目代码。
    ```bash
    # 将 <您的项目git仓库地址> 替换为实际的URL
    git clone <您的项目git仓库地址>
    
    # 进入前端项目目录
    cd EasyChat/frontend
    ```

2.  **安装项目依赖**
    在 `frontend` 目录下，运行以下命令来安装所有在 `package.json` 中声明的必需依赖包。
    ```bash
    npm install
    ```

3.  **配置环境变量 (关键步骤)**
    前端应用通过环境变量来配置一些重要的连接信息，如 AI 助手的 API 密钥和后端服务的地址。这样做可以避免将敏感信息或可变配置硬编码到代码中。
    -   在 `frontend` 目录下，**手动创建一个**名为 `.env.local` 的文件。
    -   打开这个新创建的文件，并根据您的需求填入以下变量：

    **a) 配置 DeepSeek AI 助手 (必需)**
    为了让 AI 聊天功能正常工作，您需要提供 DeepSeek 的 API 密钥。
    ```
    VUE_APP_DEEPSEEK_API_KEY="sk-xxxxxxxxxxxxxxxxxxxxxxxx"
    ```
    > 请务必将 `sk-xxxxxxxxxxxxxxxxxxxxxxxx` 替换为您的真实密钥。

    **b) 配置后端服务地址 (可选，默认为本机)**
    默认情况下，前端会尝试连接到本机（`http://localhost:5000`）的后端服务。如果您想连接到另一台计算机上（例如，局域网内的一台中央服务器）的后端，您需要指定其地址。
    ```
    VUE_APP_API_BASE_URL="http://<后端主机的IP地址>:5000"
    ```
    > **如何找到后端主机的IP地址？**
    > 在运行后端的电脑上，打开命令提示符（`cmd`）或 PowerShell，输入 `ipconfig` 命令，找到 "IPv4 地址"（通常形如 `192.168.x.x`）。
    >
    > **示例:**
    > 假设后端运行在 IP 地址为 `192.168.1.100` 的电脑上，那么您的 `.env.local` 文件内容应该像这样：
    > ```
    > VUE_APP_DEEPSEEK_API_KEY="sk-xxxxxxxxxxxxxxxxxxxxxxxx"
    > VUE_APP_API_BASE_URL="http://192.168.1.100:5000"
    > ```

## 第三步：运行开发服务器 (用于开发和测试)

在完成配置后，如果您希望在本地进行开发或快速测试，可以启动 Vue 的开发服务器。

```bash
npm run serve
```

该命令会启动一个热重载的开发服务器，通常地址为 `http://localhost:8081`。您可以在浏览器中打开这个地址查看应用。前端应用将根据您在 `.env.local` 文件中的配置，连接到指定的后端服务。

**注意**：此模式适用于开发阶段。对于正式的线上部署，请遵循第四步和第五步来创建和部署优化过的生产版本。

## 第四步：构建生产版本

配置完成后，您可以运行构建命令。这个命令会将 Vue.js 应用打包成一个为生产环境优化过、可以直接部署的静态文件包。

```bash
npm run build
```

这个命令执行完毕后，会在 `frontend` 目录下生成一个 `dist` 文件夹。这个 `dist` 文件夹包含了所有前端应用的静态资源（HTML, CSS, JavaScript 文件），它就是我们部署的最终产物。

## 第五步：部署与服务

部署的最后一步就是让用户能够通过浏览器访问到 `dist` 文件夹中的内容。这需要一个 Web 服务器来托管这些静态文件。

1.  **上传 `dist` 文件夹**
    将您本地 `frontend/dist` 文件夹中的 **所有内容** 上传到您的服务器上，您希望存放网站文件的目录（例如，Nginx 的 `/var/www/html` 或其他您自定义的路径）。

2.  **配置 Web 服务器 (以 Nginx 为例)**
    Nginx 是一款轻量、高效的服务器，非常适合托管静态网站。

    **Nginx 示例配置**:
    假设您将文件放在了服务器的 `/var/www/easychat-frontend` 目录下。您可以在 Nginx 的配置目录（如 `/etc/nginx/sites-available/`）下创建一个新的配置文件：

    ```nginx
    server {
        # 监听 80 端口 (HTTP)
        listen 80;
        
        # 替换为您的域名或服务器的公网IP地址
        server_name your_domain.com; 

        # 指向 dist 文件夹内容的根目录
        root /var/www/easychat-frontend; 
        
        # 指定默认入口文件
        index index.html;

        location / {
            # 这是处理 Vue.js 单页应用（SPA）路由的关键部分
            # 当用户直接访问一个前端路由（如 /settings）时，
            # 服务器上并没有对应的文件。这条规则会告诉 Nginx，
            # 如果请求的文件或目录不存在，就返回 /index.html 文件，
            # 让 Vue Router 来接管路由。
            try_files $uri $uri/ /index.html;
        }

        # (可选) 如果您的后端API也部署在同一台服务器上，
        # 可以配置反向代理来避免浏览器的跨域问题。
        # 这样，前端就可以直接请求 /api/users 而不是 http://localhost:5000/api/users。
        location /api {
            proxy_pass http://localhost:5000; # 假设后端服务运行在5000端口
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
    ```
    配置完成后，请务必检查Nginx配置的语法 (`nginx -t`) 并重新加载或重启 Nginx 服务 (`systemctl reload nginx`) 以使更改生效。

---

遵循以上步骤，您就可以在任何新的主机上成功地部署 EasyChat 前端应用。 